<!--
===============================================================================
模板系统使用说明 - TEMPLATE SYSTEM GUIDE
===============================================================================

本文件包含给AI的提示模板，采用自然语言格式而非技术标记语言。

如何使用:
1. 每个模板都使用有描述性的XML标签名称，如 <writer_role>...</writer_role>
2. 模板中的变量使用 {variable_name} 格式，会在运行时被替换
3. 模板分为几个主要部分:
   - 共享组件: 在多个模板中重复使用的文本块
   - 提示模板: 针对不同创作需求的主要模板
   - 响应格式: 定义AI应返回的JSON结构
   - 上下文模板: 展示玩家历史选择的格式
   - 完整提示模板: 组合以上所有元素的最终格式

编辑模板时:
- 可以直接编辑各部分的文本内容
- 保持变量名称 {variable_name} 不变
- 可以调整文本的语气、格式和表达方式
- 在Control Panel中使用"Template Preview"标签页预览完整提示

对于模板变量:
- {number_of_choices}: 要生成的选项数量
- {number_of_sentences}: 要生成的句子数量
- {word_category}: 要生成的词语类别
- {writer_role}: 写作者角色的共享定义
- {language_requirement}: 语言要求的共享定义
- {response_format}: 响应格式(JSON)的共享定义

访问Control Panel预览工具: http://localhost:3001/cp (开发模式)
===============================================================================
-->

<!-- SHARED COMPONENTS -->
<%# Common writer role - used across all templates %>
<writer_role>
作为一位擅长隐喻、符号主义、神秘学和心理分析的当代小说家
</writer_role>

<%# Common language requirement - used across all templates %>
<language_requirement>
请使用流畅自然的中文表达所有内容
</language_requirement>

<%# Common response format requirement %>
<response_format>
请以JSON格式回复，包含两个字段：
1. "thinking_process"：你的创作思路和考虑
2. "final_printed_text"：将在故事中显示的最终内容
</response_format>

<!-- PROMPT TEMPLATES IN NATURAL LANGUAGE -->
<%# Template for story choices/options %>
<dynamic_option>
我需要为我的故事创建 {number_of_choices} 个引人入胜的选择项。

{writer_role}

请提供 {number_of_choices} 个不同的故事选择，要求：
    - 选项应该有趣、多样化，适合故事上下文
    - 每个选项应简短明了，代表不同的可能性
    - {language_requirement}

{response_format}
具体格式如下：
{
    "thinking_process": "你的创作思路和考虑...",
    "final_printed_text": ["选项1", "选项2", ...]
}
</dynamic_option>
  
<%# Template for paragraph generation %>
<dynamic_text>
我需要为我的故事创建一段新的文本。

{writer_role}

请生成一段包含约 {number_of_sentences} 个句子的段落，要求：
    - 内容应生动、引人入胜，自然融入故事上下文
    - 语言应流畅、富有表现力
    - 叙述应符合整体故事的风格和基调
    - {language_requirement}

{response_format}
具体格式如下：
{
    "thinking_process": "你的创作思路和考虑...",
    "final_printed_text": "生成的段落文本"
}
</dynamic_text>
  
<%# Template for single word/phrase generation %>
<dynamic_word>
我需要为我的故事创建一个特定类型的词语。

{writer_role}

请生成一个适合故事上下文的"{word_category}"，要求：
    - 词语应表达丰富、富有暗示性，与叙述情境相关
    - 应选择能够增强故事氛围的词语
    - {language_requirement}

{response_format}
具体格式如下：
{
    "thinking_process": "你的创作思路和考虑...",
    "final_printed_text": "生成的词语"
}
</dynamic_word>
  
<!-- FORMAT TEMPLATES - NOW INTEGRATED INTO EACH TEMPLATE -->
<!-- These templates are now directly included in the main template blocks above -->
<!-- This helps writers see the exact format within context -->
<!-- The old separate templates have been removed to simplify maintenance -->
  
<!-- CONTEXT INFORMATION - PLAYER HISTORY -->
<%# Context introduction %>
<context_prefix>
--- 玩家历史选择 ---

以下是玩家之前做出的选择。请记住，这些选择表达的是隐喻和符号意义，而非字面意思。
请深入解析这些选择的象征含义，但不要在你的创作中直接引用这些原始选择。
</context_prefix>
  
<%# Format for displaying a specific player choice %>
<context_item_with_choice>
选择 #{index}：
    玩家选择了 "{chosenText}"{optionsInfo}
</context_item_with_choice>
  
<%# Format for showing available options the player chose from %>
<context_options_prefix>
    （可选项包括：
</context_options_prefix>
  
<%# Closing parenthesis for options list %>
<context_options_suffix>
    ）
</context_options_suffix>
  
<%# Format when player made no choice %>
<context_no_choice>
选择 #{index}：
    玩家未做选择
</context_no_choice>
  
<%# End of player history section %>
<context_suffix>
--- 玩家历史选择结束 ---
</context_suffix>
  
<!-- COMPLETE PROMPT TEMPLATES -->
<%# Standard prompt template without surrounding passage %>
<full_prompt>
--- 创作任务 ---
{message}

{contextString}

--- 创作要求 ---
{instructions}
</full_prompt>
  
<%# Extended prompt with surrounding passage context %>
<extended_prompt>
--- 创作任务 ---
{message}

--- 段落上下文 ---

{textBeforeDynamic}[_____这里将插入您创作的内容_____]{textAfterDynamic}

{contextString}

--- 创作要求 ---
{instructions}
</extended_prompt>